DBMS:
postgresql

Error:
org.postgresql.util.PSQLException: ERROR: syntax error at or near "@"
  Position: 333

SQL:
select concept.concept_id,
	concept.concept_name,
  	ar1.count_value as num_persons, 
	ROUND(CAST(1.0*ar1.count_value / denom.count_value AS NUMERIC),5) as percent_persons,
	ROUND(CAST(1.0*ar2.count_value / ar1.count_value AS NUMERIC),5) as records_per_person
from 
	(select cast(stratum_1 as int) stratum_1, count_value from @cdmDatabaseSchema.achilles_results where analysis_id = 400 GROUP BY analysis_id, stratum_1, count_value) ar1
	inner join
	(select cast(stratum_1 as int) stratum_1, count_value from @cdmDatabaseSchema.achilles_results where analysis_id = 401 GROUP BY analysis_id, stratum_1, count_value) ar2
	on ar1.stratum_1 = ar2.stratum_1
	inner join
	(
		select concept_id, concept_name
		from cdm.concept
		where domain_id = 'Condition'
	) concept
	on concept.concept_id = ar1.stratum_1 and concept.concept_id = ar2.stratum_1,
	(select count_value from @vocabDatabaseSchema.achilles_results where analysis_id = 1) denom
order by ar1.count_value desc


R version:
R version 4.0.3 (2020-10-10)

Platform:
x86_64-w64-mingw32

Attached base packages:
- stats
- graphics
- grDevices
- utils
- datasets
- methods
- base

Other attached packages:
- Achilles (1.6.7)
- DatabaseConnector (3.0.0)